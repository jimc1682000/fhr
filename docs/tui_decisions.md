# 新版 TUI 未決議題決策紀錄

## 摘要
為了推進新版 Textual TUI 計畫，針對 todos/new_tui_tasks.md 所列出的未決事項，我們在此彙整最終決策與後續行動。所有決策均以共享分析服務層為基礎，確保 CLI、Web、TUI 三端行為一致。

## 決策詳述

### 1. 共享服務模組命名空間
- **決策**：採用 `lib/service/` 作為共享分析服務層的命名空間。
- **理由**：
  - 與現有 `lib/` 區域一致，維持匯入路徑穩定。
  - 為後續擴充（如 state manager、i18n helper）保留清楚層次。
- **後續行動**：
  - 在 `lib/service/` 下新增 `analyzer.py`、`options.py`、`results.py` 等模組。
  - 為 CLI 與 Web 入口撰寫對應的整合調整筆記。

### 2. textual-web 模式預設值
- **決策**：維持 textual-web 為選配功能，透過 CLI 旗標 `--webview` 啟用。
- **理由**：
  - textual-web 仍屬實驗性質，需額外環境支援。
  - 可避免影響純終端使用者的體驗與依賴。
- **後續行動**：
  - 在 TUI 入口新增旗標解析與說明。
  - 文件化 textual-web 的限制與建議使用情境。

### 3. 進度呈現策略
- **決策**：統一採用「共享匯流排 + 端點個別呈現」策略。
- **理由**：
  - 既有 CLI/Web 已使用 logger 與狀態列更新，透過共用匯流排可重複利用現有邏輯。
  - Textual 可訂閱匯流排事件，提供即時進度與取消控制。
- **後續行動**：
  - 擴充共享服務層，提供 `ProgressEvent` 資料類型與訂閱介面。
  - 更新 CLI/Web/TUI 三端程式碼，使其統一透過匯流排處理進度。

## 附註
- 所有決策需同步反映在 `plans/new_tui_plan.md` 的風險因應與工作分流章節。
- 若未來 textual-web 成熟，可再評估是否將其設為預設選項。
